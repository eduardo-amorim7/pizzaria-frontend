<div class="novo-pedido-container" ng-controller="NovoPedidoController">

    <!-- Conteúdo Principal -->
    <div class="novo-pedido-content">
        
        <!-- Coluna Esquerda - Formulário -->
        <div class="novo-pedido-left">
            
            <!-- Cliente -->
            <div class="form-section">
                <div class="form-group">
                    <label>Cliente:</label>
                    <div class="cliente-input-group">
                        <div class="input-with-icon">
                            <i class="fas fa-phone"></i>
                            <input type="text" class="form-control" placeholder="3255" ng-model="pedido.cliente.telefone">
                            <i class="fas fa-caret-down"></i>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" class="form-control" placeholder="Informe o nome" ng-model="pedido.cliente.nome">
                            <i class="fas fa-caret-down"></i>
                        </div>
                    </div>
                    
                    <!-- Lista de clientes (dropdown) -->
                    <div class="clientes-dropdown" ng-show="mostrarClientesDropdown">
                        <div class="cliente-item" ng-repeat="cliente in clientesFiltrados" ng-click="selecionarCliente(cliente)">
                            <div>{{cliente.nome}} - {{cliente.telefone}}</div>
                            <div class="cliente-endereco">{{cliente.endereco}}</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modalidade -->
            <div class="form-section">
                <div class="form-group">
                    <label>Modalidade:</label>
                    <div class="modalidade-buttons">
                        <button class="modalidade-btn" 
                                ng-class="{'active': pedido.tipo === 'entrega'}"
                                ng-click="selecionarModalidade('entrega')">
                            <i class="fas fa-check-circle" ng-if="pedido.tipo === 'entrega'"></i>
                            <i class="fas fa-motorcycle" ng-if="pedido.tipo !== 'entrega'"></i>
                            Entrega
                        </button>
                        <button class="modalidade-btn"
                                ng-class="{'active': pedido.tipo === 'retirada'}"
                                ng-click="selecionarModalidade('retirada')">
                            <i class="fas fa-check-circle" ng-if="pedido.tipo === 'retirada'"></i>
                            <i class="fas fa-walking" ng-if="pedido.tipo !== 'retirada'"></i>
                            Retirada
                        </button>
                        <button class="modalidade-btn"
                                ng-class="{'active': pedido.tipo === 'balcao'}"
                                ng-click="selecionarModalidade('balcao')">
                            <i class="fas fa-check-circle" ng-if="pedido.tipo === 'balcao'"></i>
                            <i class="fas fa-utensils" ng-if="pedido.tipo !== 'balcao'"></i>
                            Balcão
                        </button>
                    </div>
                </div>
            </div>

            <!-- Combo -->
            <div class="form-section">
                <div class="form-group">
                    <label>Combo:</label>
                    <div class="combo-buttons">
                        <button class="combo-btn"
                                ng-class="{'active': comboSelecionado === 'teste'}"
                                ng-click="selecionarCombo('teste')">
                            Combo de Teste
                        </button>
                        <button class="combo-btn"
                                ng-class="{'active': comboSelecionado === 'gigante'}"
                                ng-click="selecionarCombo('gigante')">
                            Combo gigante
                        </button>
                        <button class="combo-btn"
                                ng-class="{'active': comboSelecionado === 'image'}"
                                ng-click="selecionarCombo('image')">
                            TEST IMAGE
                        </button>
                    </div>
                </div>
            </div>

            <!-- Produto -->
            <div class="form-section">
                <div class="form-group">
                    <label>Produto:</label>
                    <div class="produto-buttons">
                        <button class="produto-btn"
                                ng-class="{'active': produtoSelecionado === 'pizza'}"
                                ng-click="selecionarProduto('pizza')">
                            <i class="fas fa-check-circle" ng-if="produtoSelecionado === 'pizza'"></i>
                            <i class="fas fa-pizza-slice" ng-if="produtoSelecionado !== 'pizza'"></i>
                            Pizza
                        </button>
                        <button class="produto-btn"
                                ng-class="{'active': produtoSelecionado === 'acompanhamentos'}"
                                ng-click="selecionarProduto('acompanhamentos')">
                            <i class="fas fa-check-circle" ng-if="produtoSelecionado === 'acompanhamentos'"></i>
                            <i class="fas fa-drumstick-bite" ng-if="produtoSelecionado !== 'acompanhamentos'"></i>
                            Acompanhamentos
                        </button>
                        <button class="produto-btn"
                                ng-class="{'active': produtoSelecionado === 'burger'}"
                                ng-click="selecionarProduto('burger')">
                            <i class="fas fa-check-circle" ng-if="produtoSelecionado === 'burger'"></i>
                            <i class="fas fa-hamburger" ng-if="produtoSelecionado !== 'burger'"></i>
                            Burger
                        </button>
                        <button class="produto-btn"
                                ng-class="{'active': produtoSelecionado === 'pastel'}"
                                ng-click="selecionarProduto('pastel')">
                            <i class="fas fa-check-circle" ng-if="produtoSelecionado === 'pastel'"></i>
                            <i class="fas fa-cookie-bite" ng-if="produtoSelecionado !== 'pastel'"></i>
                            Pastel
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tamanho (apenas para Pizza) -->
            <div class="form-section" ng-show="produtoSelecionado === 'pizza'">
                <div class="form-group">
                    <label>Tamanho:</label>
                    <div class="tamanho-buttons">
                        <button class="tamanho-btn"
                                ng-class="{'active': tamanhoSelecionado === 'gigante'}"
                                ng-click="selecionarTamanho('gigante')">
                            <i class="fas fa-check-circle" ng-if="tamanhoSelecionado === 'gigante'"></i>
                            Gigante
                        </button>
                        <button class="tamanho-btn"
                                ng-class="{'active': tamanhoSelecionado === 'grande'}"
                                ng-click="selecionarTamanho('grande')">
                            <i class="fas fa-check-circle" ng-if="tamanhoSelecionado === 'grande'"></i>
                            Grande
                        </button>
                        <button class="tamanho-btn"
                                ng-class="{'active': tamanhoSelecionado === 'media'}"
                                ng-click="selecionarTamanho('media')">
                            <i class="fas fa-check-circle" ng-if="tamanhoSelecionado === 'media'"></i>
                            Média
                        </button>
                        <button class="tamanho-btn"
                                ng-class="{'active': tamanhoSelecionado === 'so_minha'}"
                                ng-click="selecionarTamanho('so_minha')">
                            <i class="fas fa-check-circle" ng-if="tamanhoSelecionado === 'so_minha'"></i>
                            Só minha
                        </button>
                        <button class="tamanho-btn"
                                ng-class="{'active': tamanhoSelecionado === 'brotinho'}"
                                ng-click="selecionarTamanho('brotinho')">
                            <i class="fas fa-check-circle" ng-if="tamanhoSelecionado === 'brotinho'"></i>
                            Brotinho
                        </button>
                    </div>
                </div>
            </div>

            <!-- Sabores (apenas para Pizza) -->
            <div class="form-section" ng-show="produtoSelecionado === 'pizza'">
                <div class="form-group">
                    <label>Sabores:</label>
                    <div class="sabores-grid">
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Alho poró') !== -1}"
                                ng-click="toggleSabor('Alho poró')">
                            Alho poró
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Calabresa') !== -1}"
                                ng-click="toggleSabor('Calabresa')">
                            Calabresa
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Florentina') !== -1}"
                                ng-click="toggleSabor('Florentina')">
                            Florentina
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Mineira') !== -1}"
                                ng-click="toggleSabor('Mineira')">
                            Mineira
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Abobrinha') !== -1}"
                                ng-click="toggleSabor('Abobrinha')">
                            Abobrinha
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Com Bacon') !== -1}"
                                ng-click="toggleSabor('Com Bacon')">
                            Com Bacon
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Frango cheddar') !== -1}"
                                ng-click="toggleSabor('Frango cheddar')">
                            Frango cheddar
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Napolitana') !== -1}"
                                ng-click="toggleSabor('Napolitana')">
                            Napolitana
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Alho') !== -1}"
                                ng-click="toggleSabor('Alho')">
                            Alho
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Filé com Catupiry') !== -1}"
                                ng-click="toggleSabor('Filé com Catupiry')">
                            Filé com Catupiry
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Hawaiana') !== -1}"
                                ng-click="toggleSabor('Hawaiana')">
                            Hawaiana
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Nápoles') !== -1}"
                                ng-click="toggleSabor('Nápoles')">
                            Nápoles
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Bolonha') !== -1}"
                                ng-click="toggleSabor('Bolonha')">
                            Bolonha
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Filé Mignon') !== -1}"
                                ng-click="toggleSabor('Filé Mignon')">
                            Filé Mignon
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Lombo ao Creme') !== -1}"
                                ng-click="toggleSabor('Lombo ao Creme')">
                            Lombo ao Creme
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Capira') !== -1}"
                                ng-click="toggleSabor('Capira')">
                            Capira
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Madre') !== -1}"
                                ng-click="toggleSabor('Madre')">
                            Madre
                        </button>
                        <button class="sabor-btn"
                                ng-class="{'active': saboresSelecionados.indexOf('Mexicana') !== -1}"
                                ng-click="toggleSabor('Mexicana')">
                            Mexicana
                        </button>
                    </div>
                    
                    <div class="sabor-search-container">
                        <div class="input-with-icon">
                            <input type="text" class="sabor-search" 
                                placeholder="Selecione um novo sabor" 
                                ng-model="buscaSabor">
                            <i class="fas fa-caret-down"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Adicionais (apenas para Pizza) -->
            <div class="form-section" ng-show="produtoSelecionado === 'pizza'">
                <div class="form-group">
                    <label>Adicionais:</label>
                    <div class="adicionais-grid">
                        <button class="adicional-btn"
                                ng-class="{'active': adicionaisSelecionados.indexOf('Sem Borda') !== -1}"
                                ng-click="toggleAdicional('Sem Borda')">
                            <i class="fas fa-check-circle" ng-if="adicionaisSelecionados.indexOf('Sem Borda') !== -1"></i>
                            Sem Borda
                        </button>
                        <button class="adicional-btn"
                                ng-class="{'active': adicionaisSelecionados.indexOf('Borda de Catupiry') !== -1}"
                                ng-click="toggleAdicional('Borda de Catupiry')">
                            <i class="fas fa-check-circle" ng-if="adicionaisSelecionados.indexOf('Borda de Catupiry') !== -1"></i>
                            Borda de Catupiry
                        </button>
                        <button class="adicional-btn"
                                ng-class="{'active': adicionaisSelecionados.indexOf('Borda cheddar') !== -1}"
                                ng-click="toggleAdicional('Borda cheddar')">
                            <i class="fas fa-check-circle" ng-if="adicionaisSelecionados.indexOf('Borda cheddar') !== -1"></i>
                            Borda cheddar
                        </button>
                        <button class="adicional-btn"
                                ng-class="{'active': adicionaisSelecionados.indexOf('Borda cream cheese') !== -1}"
                                ng-click="toggleAdicional('Borda cream cheese')">
                            <i class="fas fa-check-circle" ng-if="adicionaisSelecionados.indexOf('Borda cream cheese') !== -1"></i>
                            Borda cream cheese
                        </button>
                        <button class="adicional-btn"
                                ng-class="{'active': adicionaisSelecionados.indexOf('Borda chocolate preto') !== -1}"
                                ng-click="toggleAdicional('Borda chocolate preto')">
                            <i class="fas fa-check-circle" ng-if="adicionaisSelecionados.indexOf('Borda chocolate preto') !== -1"></i>
                            Borda chocolate preto
                        </button>
                        <button class="adicional-btn"
                                ng-class="{'active': adicionaisSelecionados.indexOf('Borda chocolate branco') !== -1}"
                                ng-click="toggleAdicional('Borda chocolate branco')">
                            <i class="fas fa-check-circle" ng-if="adicionaisSelecionados.indexOf('Borda chocolate branco') !== -1"></i>
                            Borda chocolate branco
                        </button>
                    </div>
                </div>
            </div>

            <!-- Seção especial de sabores -->
            <div class="sabores-section">
                <h6>Selecione um sabor</h6>
                <div class="sabores-opcoes">
                    <button class="sabor-opcao-btn"
                            ng-class="{'active': opcaoSaborSelecionada === 'sem_bebidas'}"
                            ng-click="selecionarOpcaoSabor('sem_bebidas')">
                        Sem Bebida
                    </button>
                    <button class="sabor-opcao-btn"
                            ng-class="{'active': opcaoSaborSelecionada === 'guarana'}"
                            ng-click="selecionarOpcaoSabor('guarana')">
                        Guaraná
                    </button>
                    <button class="sabor-opcao-btn"
                            ng-class="{'active': opcaoSaborSelecionada === 'coca_cola'}"
                            ng-click="selecionarOpcaoSabor('coca_cola')">
                        Coca Cola
                    </button>
                    <button class="sabor-opcao-btn"
                            ng-class="{'active': opcaoSaborSelecionada === 'coca_zero'}"
                            ng-click="selecionarOpcaoSabor('coca_zero')">
                        Coca Zero
                    </button>
                    <button class="sabor-opcao-btn"
                            ng-class="{'active': opcaoSaborSelecionada === 'fanta'}"
                            ng-click="selecionarOpcaoSabor('fanta')">
                        Fanta
                    </button>
                </div>
            </div>
            
            <!-- Botões de ação -->
            <div class="form-actions">
                <button class="btn-secondary" ng-click="cancelar()">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button class="btn-primary" ng-click="adicionarItem()">
                    <i class="fas fa-plus"></i> Adicionar ao Pedido
                </button>
            </div>
        </div>

        <!-- Coluna Direita - Resumo do Pedido -->
        <div class="novo-pedido-right">
            
            <!-- Itens do Pedido -->
            <div class="itens-pedido">
                <h5>Itens do Pedido</h5>
                
                <div class="item-placeholder" ng-show="pedido.itens.length === 0">
                    <div class="item-placeholder-arrows">
                        <i class="fas fa-caret-up"></i>
                        <div class="item-quantity">1</div>
                        <i class="fas fa-caret-down"></i>
                    </div>
                    <div class="item-placeholder-content">
                        <div class="item-placeholder-title">Pizza (Gigante)</div>
                        <div class="item-placeholder-details">Sem sabores</div>
                        <div class="item-placeholder-details">Sem Borda</div>
                    </div>
                    <div class="item-placeholder-price">R$ 0,00</div>
                    <div class="item-placeholder-actions">
                        <button class="btn-edit"><i class="fas fa-pencil-alt"></i></button>
                        <button class="btn-remove"><i class="fas fa-trash"></i></button>
                    </div>
                </div>

                <div class="item-pedido" ng-repeat="item in pedido.itens">
                    <div class="item-quantity-control">
                        <i class="fas fa-caret-up" ng-click="aumentarQuantidade(item)"></i>
                        <div class="item-quantity">{{item.quantidade}}</div>
                        <i class="fas fa-caret-down" ng-click="diminuirQuantidade(item)"></i>
                    </div>
                    <div class="item-content">
                        <div class="item-header">
                            <span class="item-nome">{{item.nome}}</span>
                        </div>
                        <div class="item-detalhes" ng-if="item.sabores.length > 0">
                            {{item.sabores.join(', ')}}
                        </div>
                        <div class="item-detalhes" ng-if="item.adicionais.length > 0">
                            {{item.adicionais.join(', ')}}
                        </div>
                    </div>
                    <div class="item-price">
                        R$ {{item.preco | number:2}}
                    </div>
                    <div class="item-actions">
                        <button class="btn-edit" ng-click="editarItem(item)">
                            <i class="fas fa-pencil-alt"></i>
                        </button>
                        <button class="btn-remove" ng-click="removerItem(item)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Bebidas -->
            <div class="bebidas-section">
                <div class="sem-bebidas">Sem bebidas</div>
            </div>

            <!-- Resumo Financeiro -->
            <div class="resumo-pedido">
                <div class="resumo-item">
                    <label>Taxa de Entrega:</label>
                    <div class="valor-container">
                        <div class="valor-prefix">R$</div>
                        <input type="text" class="valor-input" ng-model="pedido.taxaEntrega" ng-change="atualizarTotal()">
                    </div>
                </div>
                
                <div class="resumo-item">
                    <label>Desconto:</label>
                    <div class="valor-container">
                        <div class="valor-prefix">R$</div>
                        <div class="valor-dropdown">
                            <i class="fas fa-caret-down"></i>
                        </div>
                        <input type="text" class="valor-input" ng-model="pedido.desconto" ng-change="atualizarTotal()">
                    </div>
                </div>
                
                <div class="resumo-item">
                    <label>Cupom:</label>
                    <input type="text" class="cupom-input" ng-model="pedido.cupom">
                </div>
                
                <div class="resumo-total">
                    <span>Total do Pedido:</span>
                    <span>R$ {{calcularTotal() | number:2}}</span>
                </div>
            </div>

            <!-- Observações -->
            <div class="observacoes-section">
                <h6>Observações para o entregador...</h6>
                <textarea ng-model="pedido.observacoesEntregador" 
                          placeholder="Observações para o entregador..."></textarea>
            </div>
            
            <div class="observacoes-section">
                <h6>Observações do pedido...</h6>
                <textarea ng-model="pedido.observacoesPedido" 
                          placeholder="Observações do pedido..."></textarea>
            </div>
            
            <!-- Botões finais -->
            <div class="form-actions">
                <button class="btn-secondary" ng-click="cancelarPedido()">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button class="btn-primary" ng-click="finalizarPedido()">
                    <i class="fas fa-check"></i> Finalizar Pedido
                </button>
            </div>
        </div>
    </div>
    
    <!-- Botão de Registrar Pedido -->
    <div class="registrar-pedido-container">
        <button class="registrar-pedido-btn" ng-click="finalizarPedido()">
            <i class="fas fa-plus"></i> Registrar Pedido
        </button>
    </div>
</div>

